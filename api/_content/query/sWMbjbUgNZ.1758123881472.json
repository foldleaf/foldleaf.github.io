{"_path":"/essay/14.gin-gorm6ç¼–è¾‘ã€åˆ é™¤ç”¨æˆ·","_dir":"essay","_draft":false,"_partial":false,"_locale":"","title":"6.gin-gormç¼–è¾‘ã€åˆ é™¤ç”¨æˆ·","description":"é€šè¿‡gin-gormä¹‹é¡¹ç›®å­¦ä¹ éƒ¨åˆ†çš„å­¦ä¹ ï¼Œå¯ä»¥å¯¹é¡¹ç›®çš„æ¶æ„æœ‰æ·±å…¥çš„äº†è§£ ğŸ¤Ÿ\n{% post_link \"gin-gorm1é¡¹ç›®å‡†å¤‡åˆå§‹åŒ–\" %}\n{% post_link \"gin-gorm2æ•°æ®åº“\" %}\n{% post_link \"gin-gorm3é”™è¯¯å¤„ç†ä¸è·¯ç”±æ¥å£\" %}\n{% post_link \"gin-gorm4ç”¨æˆ·æ¨¡å—æ¥å£ç¼–å†™\" %}\n{% post_link \"gin-gorm5å¯†ç åŠ å¯†\" %}\n{% post_link \"gin-gorm6ç¼–è¾‘ã€åˆ é™¤ç”¨æˆ·\" %}","subtitle":"Edit or delete users","index":14,"date":"2023-02-13 00:00:06","lunar_date":"æ­£æœˆå»¿ä¸‰","year":"2023","month":"02","month_en":"Feb","day":"13","tag":"æŠ€æœ¯","tag_en":"TECH","cover":"/img/rabbit/014.jpg","categories":"gin-gormä¹‹é¡¹ç›®å­¦ä¹ ","body":{"type":"root","children":[{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"é€šè¿‡"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"gin-gormä¹‹é¡¹ç›®å­¦ä¹ "}]},{"type":"text","value":"éƒ¨åˆ†çš„å­¦ä¹ ï¼Œå¯ä»¥å¯¹é¡¹ç›®çš„æ¶æ„æœ‰æ·±å…¥çš„äº†è§£ ğŸ¤Ÿ\n{% post_link \"gin-gorm1é¡¹ç›®å‡†å¤‡åˆå§‹åŒ–\" %}"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n{% post_link \"gin-gorm2æ•°æ®åº“\" %}"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n{% post_link \"gin-gorm3é”™è¯¯å¤„ç†ä¸è·¯ç”±æ¥å£\" %}"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n{% post_link \"gin-gorm4ç”¨æˆ·æ¨¡å—æ¥å£ç¼–å†™\" %}"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n{% post_link \"gin-gorm5å¯†ç åŠ å¯†\" %}"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n{% post_link \"gin-gorm6ç¼–è¾‘ã€åˆ é™¤ç”¨æˆ·\" %}"},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h1","props":{"id":"åˆ é™¤ç”¨æˆ·"},"children":[{"type":"text","value":"åˆ é™¤ç”¨æˆ·"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åœ¨modelçš„Userä¸­å†™åˆ é™¤è¯­å¥"}]},{"type":"element","tag":"pre","props":{"className":["language-go"],"code":"// åˆ é™¤ç”¨æˆ·\nfunc DeleteUser(id int) int {\n    err = db.Where(\"id=?\", id).Delete(&User{}).Error\n    if err != nil {\n        return errmsg.ERROR\n    }\n    return errmsg.SUCCESS\n}\n","language":"go","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// åˆ é™¤ç”¨æˆ·\nfunc DeleteUser(id int) int {\n    err = db.Where(\"id=?\", id).Delete(&User{}).Error\n    if err != nil {\n        return errmsg.ERROR\n    }\n    return errmsg.SUCCESS\n}\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åœ¨apiçš„user.goä¸­è°ƒç”¨ï¼Œè¿”å›å‰ç«¯ä¿¡æ¯"}]},{"type":"element","tag":"pre","props":{"className":["language-go"],"code":"// åˆ é™¤ç”¨æˆ·\nfunc DeleteUser(ctx *gin.Context) {\n    id, _ := strconv.Atoi(ctx.Param(\"id\"))\n    code = model.DeleteUser(id)\n    ctx.JSON(http.StatusOK, gin.H{\n        \"status\":  code,\n        \"message\": errmsg.GetErrMsg(code),\n    })\n\n}\n","language":"go","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// åˆ é™¤ç”¨æˆ·\nfunc DeleteUser(ctx *gin.Context) {\n    id, _ := strconv.Atoi(ctx.Param(\"id\"))\n    code = model.DeleteUser(id)\n    ctx.JSON(http.StatusOK, gin.H{\n        \"status\":  code,\n        \"message\": errmsg.GetErrMsg(code),\n    })\n\n}\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åˆ é™¤ä¸ºè½¯åˆ é™¤ï¼Œå³å°†æ•°æ®æ ‡è®°ä¸ºåˆ é™¤çŠ¶æ€ï¼Œæ•°æ®ä»ä¿ç•™åœ¨æ•°æ®åº“ä¸­ï¼Œä»¥ç¡®ä¿æ•°æ®åº“çš„å®Œæ•´æ€§å’Œå¯æ¢å¤æ€§"}]},{"type":"element","tag":"h1","props":{"id":"ç¼–è¾‘ç”¨æˆ·"},"children":[{"type":"text","value":"ç¼–è¾‘ç”¨æˆ·"}]},{"type":"element","tag":"pre","props":{"className":["language-go"],"code":"// ç¼–è¾‘ç”¨æˆ·(å¯†ç é™¤å¤–)\nfunc EditUser(id int, data *User) int {\n    var maps = make(map[string]interface{})\n    maps[\"username\"] = data.Username\n    maps[\"role\"] = data.Role\n    err = db.Model(&User{}).Where(\"id=?\", id).Updates(maps).Error\n    if err != nil {\n        return errmsg.ERROR\n    }\n    return errmsg.SUCCESS\n}\n","language":"go","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// ç¼–è¾‘ç”¨æˆ·(å¯†ç é™¤å¤–)\nfunc EditUser(id int, data *User) int {\n    var maps = make(map[string]interface{})\n    maps[\"username\"] = data.Username\n    maps[\"role\"] = data.Role\n    err = db.Model(&User{}).Where(\"id=?\", id).Updates(maps).Error\n    if err != nil {\n        return errmsg.ERROR\n    }\n    return errmsg.SUCCESS\n}\n"}]}]},{"type":"element","tag":"pre","props":{"className":["language-go"],"code":"// ç¼–è¾‘ç”¨æˆ·\nfunc EditUser(ctx *gin.Context) {\n    var data model.User\n    id, _ := strconv.Atoi(ctx.Param(\"id\"))\n    ctx.ShouldBindJSON(data)\n    code = model.CheckUser(data.Username)\n    if code == errmsg.SUCCESS {\n        model.EditUser(id, &data)\n    }\n    if code == errmsg.ERROR_USERNAME_USED {\n        ctx.Abort()\n    }\n    ctx.JSON(http.StatusOK, gin.H{\n        \"status\":  code,\n        \"message\": errmsg.GetErrMsg(code),\n    })\n\n}\n","language":"go","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// ç¼–è¾‘ç”¨æˆ·\nfunc EditUser(ctx *gin.Context) {\n    var data model.User\n    id, _ := strconv.Atoi(ctx.Param(\"id\"))\n    ctx.ShouldBindJSON(data)\n    code = model.CheckUser(data.Username)\n    if code == errmsg.SUCCESS {\n        model.EditUser(id, &data)\n    }\n    if code == errmsg.ERROR_USERNAME_USED {\n        ctx.Abort()\n    }\n    ctx.JSON(http.StatusOK, gin.H{\n        \"status\":  code,\n        \"message\": errmsg.GetErrMsg(code),\n    })\n\n}\n"}]}]}],"toc":{"title":"","searchDepth":2,"depth":3,"links":[]}},"_type":"markdown","_id":"content:essay:14.gin-gorm6ç¼–è¾‘ã€åˆ é™¤ç”¨æˆ·.md","_source":"content","_file":"essay/14.gin-gorm6ç¼–è¾‘ã€åˆ é™¤ç”¨æˆ·.md","_stem":"essay/14.gin-gorm6ç¼–è¾‘ã€åˆ é™¤ç”¨æˆ·","_extension":"md"}
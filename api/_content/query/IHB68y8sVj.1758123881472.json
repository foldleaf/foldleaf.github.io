{"_path":"/essay/7.ArchLinux重开备忘录","_dir":"essay","_draft":false,"_partial":false,"_locale":"","title":"ArchLinux重开备忘录","description":"时常记得：sudo pacman -Syu\n万一哪天挂了或用新电脑时，方便自己快速重开。\n第二次安装成功，nice.\n原来16G太小了，重新分配40G再装了一遍，第三次安装成功。","subtitle":"ArchLinuxを再開する","index":7,"date":"2023-02-05 21:39:03","lunar_date":"正月十五","year":"2023","month":"02","month_en":"Feb","day":"05","tag":"技术","tag_en":"TECH","cover":"/img/rabbit/007.jpg","categories":"linux","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"时常记得："},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo pacman -Syu"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n万一哪天挂了或用新电脑时，方便自己快速重开。"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n第二次安装成功，nice."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n原来16G太小了，重新分配40G再装了一遍，第三次安装成功。"}]},{"type":"element","tag":"h1","props":{"id":"可能用到的链接"},"children":[{"type":"text","value":"可能用到的链接"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Arch wiki"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"a","props":{"href":"https://wiki.archlinux.org/","rel":["nofollow"]},"children":[{"type":"text","value":"https://wiki.archlinux.org/"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"vmware虚拟机安装archlinux"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"a","props":{"href":"https://blog.csdn.net/takashi77/article/details/118927109","rel":["nofollow"]},"children":[{"type":"text","value":"https://blog.csdn.net/takashi77/article/details/118927109"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"重启后网络ping不通"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n网络问题解决方案"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"a","props":{"href":"https://blog.csdn.net/kaluosifa/article/details/105303484","rel":["nofollow"]},"children":[{"type":"text","value":"https://blog.csdn.net/kaluosifa/article/details/105303484"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"安装plasma桌面环境 虚拟机安装不需要配置显卡驱动，其实这个应该是最全最好用的，不过我是装好了Arch后要装kde出错后才找到这个不错的完全体教程"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"a","props":{"href":"https://arch.icekylin.online/rookie/desktop-env-and-app.html#_4-%E5%AE%89%E8%A3%85-kde-plasma-%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83","rel":["nofollow"]},"children":[{"type":"text","value":"https://arch.icekylin.online/rookie/desktop-env-and-app.html#_4-%E5%AE%89%E8%A3%85-kde-plasma-%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"安装可能用到的命令"}]},{"type":"element","tag":"pre","props":{"code":"ping arch.icekylin.online\ntimedatectl set-ntp true\ntimedatectl status\nvim /etc/pacman.d/mirrorlist\n# 分区和挂载系列命令\npacstrap /mnt base base-devel linux linux-firmware\npacstrap /mnt dhcpcd iwd vim sudo bash-completion\ngenfstab -U /mnt > /mnt/etc/fstab\ncat /mnt/etc/fstab\narch-chroot /mnt\nvim /etc/hostname\nvim /etc/hosts\nln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\nhwclock --systohc\nlocale-gen\necho 'LANG=en_US.UTF-8'  > /etc/locale.conf\npasswd root\npacman -S intel-ucode\npacman -S grub efibootmgr\ngrub-install --target=x86_64-efi --efi-directory=/efi --bootloader-id=ARCH\nvim /etc/default/grub\ngrub-mkconfig -o /boot/grub/grub.cfg\nexit\numount -R /mnt\nreboot\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"ping arch.icekylin.online\ntimedatectl set-ntp true\ntimedatectl status\nvim /etc/pacman.d/mirrorlist\n# 分区和挂载系列命令\npacstrap /mnt base base-devel linux linux-firmware\npacstrap /mnt dhcpcd iwd vim sudo bash-completion\ngenfstab -U /mnt > /mnt/etc/fstab\ncat /mnt/etc/fstab\narch-chroot /mnt\nvim /etc/hostname\nvim /etc/hosts\nln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\nhwclock --systohc\nlocale-gen\necho 'LANG=en_US.UTF-8'  > /etc/locale.conf\npasswd root\npacman -S intel-ucode\npacman -S grub efibootmgr\ngrub-install --target=x86_64-efi --efi-directory=/efi --bootloader-id=ARCH\nvim /etc/default/grub\ngrub-mkconfig -o /boot/grub/grub.cfg\nexit\numount -R /mnt\nreboot\n"}]}]},{"type":"element","tag":"h1","props":{"id":"安装准备"},"children":[{"type":"text","value":"安装准备"}]},{"type":"element","tag":"h2","props":{"id":"下载软件"},"children":[{"type":"text","value":"下载软件"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"前往官网 "},{"type":"element","tag":"a","props":{"href":"https://archlinux.org/download/","rel":["nofollow"]},"children":[{"type":"text","value":"https://archlinux.org/download/"}]},{"type":"text","value":" 下载Arch镜像，往下划选择一个国内的镜像源，这里选用的是aliyun，选择iso映像文件下载"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"下载虚拟机 VMware 或visual box都可以，这里使用的是VMware"}]},{"type":"element","tag":"h2","props":{"id":"创建虚拟机"},"children":[{"type":"text","value":"创建虚拟机"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"创建虚拟机："}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"典型配置"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"安装程序光盘映像文件-选择刚刚下载好的iso映像文件"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"操作系统选择Linux-版本选择其他Linux内核64位"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"设置虚拟机名称和位置"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"分配内存 我是16g硬盘 2g内存 后面装kde后感觉有点小了？"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"其他默认，之后可以在虚拟机-设置里更改"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"创建完成后请勿直接开启虚拟机，因为会默认使用bios方式启动，我们这里要改用efi方式启动"}]},{"type":"element","tag":"h1","props":{"id":"开始安装"},"children":[{"type":"text","value":"开始安装"}]},{"type":"element","tag":"h2","props":{"id":"开启虚拟机"},"children":[{"type":"text","value":"开启虚拟机"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"更改为UEFI引导: 虚拟机-设置-选项-高级-固件类型，将BIOS选项改为UEFI，确定。因为我们之后的分区类型和引导程序都是用EFI的"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n开启虚拟机，第一个选项 enter"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n测试网络，开通则有数据显示，安装镜像时应该已经预配置了网络"}]},{"type":"element","tag":"pre","props":{"code":"ping www.bilibili.com\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"ping www.bilibili.com\n"}]}]},{"type":"element","tag":"h2","props":{"id":"时间"},"children":[{"type":"text","value":"时间"}]},{"type":"element","tag":"pre","props":{"code":"# 通过 npt 校准时间\ntimedatectl set-ntp true\n# 查看时间\ntimedatectl status\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 通过 npt 校准时间\ntimedatectl set-ntp true\n# 查看时间\ntimedatectl status\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果与实际时间相差 8 小时，那是因为我们用的东八区时间与UTC标准时间相差 8 小时：\n设置时区为上海，我是安装完后才设置的"}]},{"type":"element","tag":"pre","props":{"code":"ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n"}]}]},{"type":"element","tag":"h2","props":{"id":"磁盘分区"},"children":[{"type":"text","value":"磁盘分区"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"lsblk查看磁盘分区情况，未分区时磁盘sda 16G"}]},{"type":"element","tag":"pre","props":{"code":"# 进入磁盘分区系统\ncfdisk /dev/sda\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 进入磁盘分区系统\ncfdisk /dev/sda\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"然后选择 gpt 方式进入分区，上下键选择分区、左右键选择下方的操作命令，回车执行操作"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"new 新建分区然后输入分区大小，即可将当前磁盘划分出一块分区"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"type 分区类型"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"write 写入磁盘，如果没有 write 直接 quit 则分区操作不会生效"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"delete 删除分区"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"quit 退出分区操作"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"分区sd1：new - 输入大小（参考：512M）- type - EFI System"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n分区sd2：new - 输入大小（参考：12G）- type - Linux root(x86-64)"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n分区sd3：输入大小（参考：剩下的3.5G）- type - Linux swap"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"确定完成分区后 write - 最后 quit"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\n使用lsblk查看分区后的磁盘"}]},{"type":"element","tag":"h2","props":{"id":"初始化分区"},"children":[{"type":"text","value":"初始化分区"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"格式化分区"}]},{"type":"element","tag":"pre","props":{"code":"mkfs.fat -F32 /dev/sda1\nmkfs.ext4 /dev/sda2\nmkswap /dev/sda3 -L Swap\nswapon /dev/sda3\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"mkfs.fat -F32 /dev/sda1\nmkfs.ext4 /dev/sda2\nmkswap /dev/sda3 -L Swap\nswapon /dev/sda3\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"挂载分区"}]},{"type":"element","tag":"pre","props":{"code":"mount /dev/sda2 /mnt\nmkdir -p /mnt/boot/EFI\nmount /dev/sda1 /mnt/boot/EFI\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"mount /dev/sda2 /mnt\nmkdir -p /mnt/boot/EFI\nmount /dev/sda1 /mnt/boot/EFI\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"使用vim打开下载镜像列表"}]},{"type":"element","tag":"pre","props":{"code":"vim /etc/pacman.d/mirrorlist\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"vim /etc/pacman.d/mirrorlist\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在里面列表第一行添加中国境内的源，这里使用aliyun"}]},{"type":"element","tag":"pre","props":{"code":"Server = http://mirrors.aliyun.com/archlinux/$repo/os/$arch\n","language":"vim","meta":"","className":["language-vim"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"Server = http://mirrors.aliyun.com/archlinux/$repo/os/$arch\n"}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"假如你不会vim，你只需要了解在本文中你会用到的 vim 操作："}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"按 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"i"}]},{"type":"text","value":" 进入插入模式，在插入模式下才可以对文件进行修改"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"按 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"esc"}]},{"type":"text","value":" 进入命令模式，可以多按几次 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"esc"}]},{"type":"text","value":" 以确保你处于命令模式，在命令模式下不能对文件进行修改"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"在命令模式下，可以输入一些命令，在本文中你会用到的命令如下\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":":/"}]},{"type":"text","value":"为查找命令，后面家上你要查找的文本，vim 会跳转到匹配的那一行，按 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"N"}]},{"type":"text","value":" 查找下一个"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":":w"}]},{"type":"text","value":" 保存修改"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":":wq"}]},{"type":"text","value":" 保存修改并退出 vim"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":":q!"}]},{"type":"text","value":" 强制退出"}]}]}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"系统安装"},"children":[{"type":"text","value":"系统安装"}]},{"type":"element","tag":"pre","props":{"code":"# 这是为/mnt下安装一些环境用于待会创建用户所使用的，包括一些基本环境以及网络相关的dhcpcd和net-tools\npacstrap -i /mnt base base-devel linux vim dhcpcd net-tools\n# 生成 fstab 文件 (用 -U 或 -L 选项设置UUID 或卷标)：\ngenfstab -U /mnt >> /mnt/etc/fstab\n# 查看是否生成了磁盘分区\ncat /mnt/etc/fstab\n# 切换用户,原来 root是红色，切换成功后变为灰色\narch-chroot /mnt\n# 创建初始的ramdisk环境\nmkinitcpio -p linux\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 这是为/mnt下安装一些环境用于待会创建用户所使用的，包括一些基本环境以及网络相关的dhcpcd和net-tools\npacstrap -i /mnt base base-devel linux vim dhcpcd net-tools\n# 生成 fstab 文件 (用 -U 或 -L 选项设置UUID 或卷标)：\ngenfstab -U /mnt >> /mnt/etc/fstab\n# 查看是否生成了磁盘分区\ncat /mnt/etc/fstab\n# 切换用户,原来 root是红色，切换成功后变为灰色\narch-chroot /mnt\n# 创建初始的ramdisk环境\nmkinitcpio -p linux\n"}]}]},{"type":"element","tag":"h2","props":{"id":"locale地区和语言配置"},"children":[{"type":"text","value":"locale地区和语言配置"}]},{"type":"element","tag":"pre","props":{"code":"# 用 vim 打开locale配置文件\nvim /etc/locale.gen\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 用 vim 打开locale配置文件\nvim /etc/locale.gen\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"查找以下3项，去掉前面的 # 号\nvim命令模式输入 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":":/en_US.UTF-8 UTF-8"}]},{"type":"text","value":"  查找"}]},{"type":"element","tag":"pre","props":{"code":"en_US.UTF-8 UTF-8\nzh_CN.UTF-8 UTF-8\nzh_TW.UTF-8 UTF-8\n","language":"vim","meta":"","className":["language-vim"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"en_US.UTF-8 UTF-8\nzh_CN.UTF-8 UTF-8\nzh_TW.UTF-8 UTF-8\n"}]}]},{"type":"element","tag":"pre","props":{"code":"# 生成Locale信息\nlocale-gen\n# 列出所有启用的Locale\nlocale -a\n# 创建locale.conf文件，并提交所要使用的本地化选项\n# 不推荐此时设置任何中文locale，这样做可能会导致tty显示乱码\necho LANG=en_US.UTF-8 > /etc/locale.conf\n# 显示当前正在使用的Locale和相关的环境变量\nlocale\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 生成Locale信息\nlocale-gen\n# 列出所有启用的Locale\nlocale -a\n# 创建locale.conf文件，并提交所要使用的本地化选项\n# 不推荐此时设置任何中文locale，这样做可能会导致tty显示乱码\necho LANG=en_US.UTF-8 > /etc/locale.conf\n# 显示当前正在使用的Locale和相关的环境变量\nlocale\n"}]}]},{"type":"element","tag":"h2","props":{"id":"设置主机名"},"children":[{"type":"text","value":"设置主机名"}]},{"type":"element","tag":"pre","props":{"code":"# 创建 /etc/hostname 文件并将主机名写入文件,比如主机名为 arch\necho arch > /etc/hostname\n# 然后用 vim打开 /etc/hosts 配置\nvim /etc/hosts\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 创建 /etc/hostname 文件并将主机名写入文件,比如主机名为 arch\necho arch > /etc/hostname\n# 然后用 vim打开 /etc/hosts 配置\nvim /etc/hosts\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"写入以下内容，保存并退出"}]},{"type":"element","tag":"pre","props":{"code":"127.0.0.1    localhost.localdomain    localhost\n::1          localhost.localdomain    localhost\n127.0.1.1    arch.localdomain    arch \n","language":"vim","meta":"","className":["language-vim"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"127.0.0.1    localhost.localdomain    localhost\n::1          localhost.localdomain    localhost\n127.0.1.1    arch.localdomain    arch \n"}]}]},{"type":"element","tag":"h2","props":{"id":"网络配置"},"children":[{"type":"text","value":"网络配置"}]},{"type":"element","tag":"pre","props":{"code":"pacman -S dhcpcd\nsystemctl enable dhcpcd.service\n\n使用无线网络的话，则需安装以下几个软件包（未验证）\npacman -S iw wpa_supplicant dialog  （有线网络忽略这行）\n\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"pacman -S dhcpcd\nsystemctl enable dhcpcd.service\n\n使用无线网络的话，则需安装以下几个软件包（未验证）\npacman -S iw wpa_supplicant dialog  （有线网络忽略这行）\n\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"另一个教程里无线网络的配置"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"a","props":{"href":"https://arch.icekylin.online/rookie/basic-install.html#%E8%8B%A5%E4%BD%BF%E7%94%A8%E6%97%A0%E7%BA%BF%E8%BF%9E%E6%8E%A5","rel":["nofollow"]},"children":[{"type":"text","value":"https://arch.icekylin.online/rookie/basic-install.html#%E8%8B%A5%E4%BD%BF%E7%94%A8%E6%97%A0%E7%BA%BF%E8%BF%9E%E6%8E%A5"}]}]},{"type":"element","tag":"pre","props":{"code":"iwctl # 进入交互式命令行\ndevice list # 列出无线网卡设备名，比如无线网卡看到叫 wlan0\nstation wlan0 scan # 扫描网络\nstation wlan0 get-networks # 列出所有 wifi 网络\nstation wlan0 connect wifi-name # 进行连接，注意这里无法输入中文。回车后输入密码即可\nexit # 连接成功后退出\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"iwctl # 进入交互式命令行\ndevice list # 列出无线网卡设备名，比如无线网卡看到叫 wlan0\nstation wlan0 scan # 扫描网络\nstation wlan0 get-networks # 列出所有 wifi 网络\nstation wlan0 connect wifi-name # 进行连接，注意这里无法输入中文。回车后输入密码即可\nexit # 连接成功后退出\n"}]}]},{"type":"element","tag":"h2","props":{"id":"root用户密码及创建新用户"},"children":[{"type":"text","value":"root用户密码及创建新用户"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"设置 root 密码"}]},{"type":"element","tag":"pre","props":{"code":"# 输入时密码会隐藏，你不会看到你输入的任何东西，这是正常的。确定密码输入完后回车\npasswd\n# 二次确认密码，密码同样会隐藏\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 输入时密码会隐藏，你不会看到你输入的任何东西，这是正常的。确定密码输入完后回车\npasswd\n# 二次确认密码，密码同样会隐藏\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"root用户拥有系统的所有操作权限，这样对系统的操作非常不安全，所以需要新建一个普通用户，让其对系统的操作受到一定限制,后面要用的 kde 也只能由非 root 用户使用"}]},{"type":"element","tag":"pre","props":{"code":"# 创建新用户，比如用户名为free\nuseradd -m -G wheel -s /bin/bash free\n# 设置用户密码\npasswd free\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 创建新用户，比如用户名为free\nuseradd -m -G wheel -s /bin/bash free\n# 设置用户密码\npasswd free\n"}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"-m：创建用户主目录（/home/"},{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"用户名"}]},{"type":"text","value":"）\n-G：用户要加入的附加组列表；此处将用户加到wheel组中，之后可以给这个组执行sudo命令的权限\n-s：指定了用户默认登录shell的路径，此处设置为bash的路径"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"给予普通用户使用 root 的权限"}]},{"type":"element","tag":"pre","props":{"code":"# 打开sudoers文件后\nvisudo\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 打开sudoers文件后\nvisudo\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"删除wheel组前面的注释符号即可，之后普通用户在命令之前加上 sudo 就能以 root 权限执行命令"}]},{"type":"element","tag":"h2","props":{"id":"安装引导程序-grub"},"children":[{"type":"text","value":"安装引导程序 grub"}]},{"type":"element","tag":"pre","props":{"code":"# arch下载软件命令：pacman -S <软件名>\n# 因为我们使用的是虚拟机和UEFI引导方式，因此只需要安装grub和efibootmgr：\npacman -S grub efibootmgr\n# 将其安装到EFI分区当中\ngrub-install --recheck /dev/sda\n# 生成 grub 的配置文件：\ngrub-mkconfig -o /boot/grub/grub.cfg\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# arch下载软件命令：pacman -S <软件名>\n# 因为我们使用的是虚拟机和UEFI引导方式，因此只需要安装grub和efibootmgr：\npacman -S grub efibootmgr\n# 将其安装到EFI分区当中\ngrub-install --recheck /dev/sda\n# 生成 grub 的配置文件：\ngrub-mkconfig -o /boot/grub/grub.cfg\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"安装完毕"}]},{"type":"element","tag":"h2","props":{"id":"退出重启安装完成"},"children":[{"type":"text","value":"退出重启，安装完成"}]},{"type":"element","tag":"pre","props":{"code":"# 退回安装环境\nexit\n# 卸载新分区\numount -R /mnt\n# 重启\nreboot\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 退回安装环境\nexit\n# 卸载新分区\numount -R /mnt\n# 重启\nreboot\n"}]}]},{"type":"element","tag":"h2","props":{"id":"开启网络"},"children":[{"type":"text","value":"开启网络"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"重启后使用登录，若使用普通用户登录则有些命令之前需要加 sudo 以获得 root权限"}]},{"type":"element","tag":"pre","props":{"code":"# 设置开机自启并立即启动 dhcp 服务\nsystemctl enable --now dhcpcd \n# 测试网络连接\nping www.bilibili.com \n\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 设置开机自启并立即启动 dhcp 服务\nsystemctl enable --now dhcpcd \n# 测试网络连接\nping www.bilibili.com \n\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"若为无线连接，还需要"}]},{"type":"element","tag":"pre","props":{"code":"systemctl start iwd # 立即启动 iwd\niwctl # 和之前的方式一样，连接无线网络\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"systemctl start iwd # 立即启动 iwd\niwctl # 和之前的方式一样，连接无线网络\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"而本人之前遇到网络问题的解决方式，亲测可用"}]},{"type":"element","tag":"pre","props":{"code":"# 检查网络接口\nip link\n# 开启第二个接口\nip link set dev ens33 up\n# 使用 dhcpcd 分配网络地址\ndhcpcd\n# 将 dhcpcd 设置为自启\nsystemctl enable dhcpcd\nsystemctl disable dhcpcd        // 取消自启\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 检查网络接口\nip link\n# 开启第二个接口\nip link set dev ens33 up\n# 使用 dhcpcd 分配网络地址\ndhcpcd\n# 将 dhcpcd 设置为自启\nsystemctl enable dhcpcd\nsystemctl disable dhcpcd        // 取消自启\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"到此 ArchLinux 已经安装完成啦，撒花❀，但是此时只有命令行的界面，稍后我们将安装图形化界面"}]},{"type":"element","tag":"h1","props":{"id":"图形化桌面-kdeplasma"},"children":[{"type":"text","value":"图形化桌面-KDE(plasma)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Linux 的图形化桌面有 KDE、GONE、xfce等等，这里使用 KDE"}]},{"type":"element","tag":"h2","props":{"id":"安装-kde-plasma桌面环境"},"children":[{"type":"text","value":"安装 KDE plasma桌面环境"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"安装最小相关软件包"}]},{"type":"element","tag":"pre","props":{"code":"# plasma-meta 元软件包、konsole 终端模拟器和 dolphin 文件管理器\nsudo pacman -S plasma-meta konsole dolphin \n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# plasma-meta 元软件包、konsole 终端模拟器和 dolphin 文件管理器\nsudo pacman -S plasma-meta konsole dolphin \n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"kde-applications则是 kde 全家桶\n"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo pacman -S plasma kde-applications"}]},{"type":"text","value":"\n其中很多都没必要，而且我第一次装完后登录只显示黑屏与鼠标，不知道是部件有问题还是磁盘空间太小（应该是后者？使用最小包安装成功后我sda2 12g的存储空间只剩5g了）\n假如你不慎安装了 kde 全家桶，想要卸载，可以使用以下命令卸载"}]},{"type":"element","tag":"pre","props":{"code":"sudo pacman -Rsc plasma\nsudo pacman -Rsc kde-applications\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo pacman -Rsc plasma\nsudo pacman -Rsc kde-applications\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"kde 默认安装的是 xorg，如果想使用wayland的话安装以下包："}]},{"type":"element","tag":"pre","props":{"code":"pacman -S  plasma-wayland-session xdg-desktop-portal\n# N卡用户需要额外安装egl-wayland,xdg-desktop-portal包是为了如obs此类工具录制屏幕使用\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"pacman -S  plasma-wayland-session xdg-desktop-portal\n# N卡用户需要额外安装egl-wayland,xdg-desktop-portal包是为了如obs此类工具录制屏幕使用\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"安装完成后，可以在登录时选择使用 xorg 还是 wayland\n另外，虚拟机环境下不需要显卡驱动"}]},{"type":"element","tag":"h2","props":{"id":"配置-sddm"},"children":[{"type":"text","value":"配置 sddm"}]},{"type":"element","tag":"pre","props":{"code":"systemctl enable sddm\nsystemctl start sddm  # 直接启动显示管理器，与以下reboot命令二选一即可\nreboot\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"systemctl enable sddm\nsystemctl start sddm  # 直接启动显示管理器，与以下reboot命令二选一即可\nreboot\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"基本的 kde 就安装完成了，之后更改需要的配置，挑选喜欢的主题，查找美化的教程，安装需要的软件，时常记得 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo pacman -Syu"}]},{"type":"text","value":" 滚动更新防止滚挂"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"完结撒花，可以愉快地玩耍啦 ❀"}]},{"type":"element","tag":"h1","props":{"id":"软件源配置"},"children":[{"type":"text","value":"软件源配置"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"执行安装 archlinuxcn 源所需的相关步骤："}]},{"type":"element","tag":"pre","props":{"code":"sudo pacman -S archlinuxcn-keyring # cn 源中的签名（archlinuxcn-keyring 在 archlinuxcn）\nsudo pacman -S yay # yay 命令可以让用户安装 AUR 中的软件（yay 在 archlinuxcn）\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo pacman -S archlinuxcn-keyring # cn 源中的签名（archlinuxcn-keyring 在 archlinuxcn）\nsudo pacman -S yay # yay 命令可以让用户安装 AUR 中的软件（yay 在 archlinuxcn）\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"若安装 archlinuxcn-keyring 时报错，是由于密钥环的问题。\n以root 权限运行"}]},{"type":"element","tag":"pre","props":{"code":"pacman -Syu haveged\nsystemctl start haveged\nsystemctl enable haveged\n\nrm -fr /etc/pacman.d/gnupg\npacman-key --init\npacman-key --populate archlinux\npacman-key --populate archlinuxcn\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"pacman -Syu haveged\nsystemctl start haveged\nsystemctl enable haveged\n\nrm -fr /etc/pacman.d/gnupg\npacman-key --init\npacman-key --populate archlinux\npacman-key --populate archlinuxcn\n"}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"出现这个问题"}]},{"type":"element","tag":"pre","props":{"code":"错误：密钥环文件 `/usr/share/pacman/keyrings/archlinuxcn.gpg` 不存在。\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"错误：密钥环文件 `/usr/share/pacman/keyrings/archlinuxcn.gpg` 不存在。\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"解决方法是通过git方式安装yay，再通过yay安装archlinuxcn"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"git 安装yay"}]},{"type":"element","tag":"pre","props":{"code":"# 安装 git\nsudo pacman -S base-devel \nsudo pacman -S git\n# 进入 /opt 目录并克隆 yay 稳定版的 git 仓库。\ncd /opt\nsudo git clone https://aur.archlinux.org/yay.git\n# 更改源目录的所有者。将 debugpoint 替换为你的用户名。\nsudo chown -R free:users ./yay\n# 进入目录进行编译\ncd yay\nmakepkg -si\n# 安装中出现 build 错误，卡在下载一个 go 的依赖包\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 安装 git\nsudo pacman -S base-devel \nsudo pacman -S git\n# 进入 /opt 目录并克隆 yay 稳定版的 git 仓库。\ncd /opt\nsudo git clone https://aur.archlinux.org/yay.git\n# 更改源目录的所有者。将 debugpoint 替换为你的用户名。\nsudo chown -R free:users ./yay\n# 进入目录进行编译\ncd yay\nmakepkg -si\n# 安装中出现 build 错误，卡在下载一个 go 的依赖包\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 makepkg 过程中会因为go依赖的问题卡住，换源后再makepkg"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"不过go的代理推荐改用"},{"type":"element","tag":"a","props":{"href":"https://proxy.golang.com.cn","rel":["nofollow"]},"children":[{"type":"text","value":"https://proxy.golang.com.cn"}]},{"type":"text","value":", 感觉其他代理有时不太行，因为在安装vscode的go工具时下载有时会失败"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"a","props":{"href":"https://zhuanlan.zhihu.com/p/439805266","rel":["nofollow"]},"children":[{"type":"text","value":"https://zhuanlan.zhihu.com/p/439805266"}]}]},{"type":"element","tag":"pre","props":{"code":"cd /opt\ncd yay\nmakepkg -si \n# yay 安装 archlinuxcn-keyring\nyay -S archlinuxcn-keyring\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"cd /opt\ncd yay\nmakepkg -si \n# yay 安装 archlinuxcn-keyring\nyay -S archlinuxcn-keyring\n"}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"问题已解决,推荐用上面的方法，下面安装keyring后，安装一些软件如v2ray时还是有密钥问题，上面的方法已经完全解决问题了，不过换源还是可以换一下的"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"使用"},{"type":"element","tag":"a","props":{"href":"http://mirrors.ustc.edu.cn/help/archlinuxcn.html","rel":["nofollow"]},"children":[{"type":"text","value":"中科大镜像源"}]},{"type":"text","value":"，用清华源失败了，还是中科大的靠谱"}]},{"type":"element","tag":"pre","props":{"code":"sudo vim /etc/pacman.conf\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo vim /etc/pacman.conf\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在末尾添加"}]},{"type":"element","tag":"pre","props":{"code":"[archlinuxcn]\nServer = https://mirrors.ustc.edu.cn/archlinuxcn/$arch\n","language":"vim","meta":"","className":["language-vim"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"[archlinuxcn]\nServer = https://mirrors.ustc.edu.cn/archlinuxcn/$arch\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"安装 archlinuxcn-keyring"}]},{"type":"element","tag":"pre","props":{"code":"sudo pacman -S archlinuxcn-keyring \n# 如出现错误让你使用 -Sy 安装\nsudo pacman -Sy archlinuxcn-keyring \n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo pacman -S archlinuxcn-keyring \n# 如出现错误让你使用 -Sy 安装\nsudo pacman -Sy archlinuxcn-keyring \n"}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h1","props":{"id":"软件安装"},"children":[{"type":"text","value":"软件安装"}]},{"type":"element","tag":"pre","props":{"code":"sudo pacman -S firefox chromium # 安装常用的火狐、chromium 浏览器\nsudo pacman -S ark # 压缩软件。在 dolphin 中可用右键解压压缩包\nsudo pacman -S gwenview # 图片查看器\nsudo pacman -S code # all in vscode，yyds\nsudo pacman -S go # golang\nsudo pacman -S java # java 其他编程语言应该都类似安装\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo pacman -S firefox chromium # 安装常用的火狐、chromium 浏览器\nsudo pacman -S ark # 压缩软件。在 dolphin 中可用右键解压压缩包\nsudo pacman -S gwenview # 图片查看器\nsudo pacman -S code # all in vscode，yyds\nsudo pacman -S go # golang\nsudo pacman -S java # java 其他编程语言应该都类似安装\n"}]}]},{"type":"element","tag":"h1","props":{"id":"进一步美化桌面"},"children":[{"type":"text","value":"进一步美化桌面"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://zhuanlan.zhihu.com/p/558354279","rel":["nofollow"]},"children":[{"type":"text","value":"https://zhuanlan.zhihu.com/p/558354279"}]}]},{"type":"element","tag":"h1","props":{"id":"透明代理"},"children":[{"type":"text","value":"透明代理"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"sudo pacman -S v2ray v2raya"}]}],"toc":{"title":"","searchDepth":2,"depth":3,"links":[{"id":"下载软件","depth":2,"text":"下载软件"},{"id":"创建虚拟机","depth":2,"text":"创建虚拟机"},{"id":"开启虚拟机","depth":2,"text":"开启虚拟机"},{"id":"时间","depth":2,"text":"时间"},{"id":"磁盘分区","depth":2,"text":"磁盘分区"},{"id":"初始化分区","depth":2,"text":"初始化分区"},{"id":"系统安装","depth":2,"text":"系统安装"},{"id":"locale地区和语言配置","depth":2,"text":"locale地区和语言配置"},{"id":"设置主机名","depth":2,"text":"设置主机名"},{"id":"网络配置","depth":2,"text":"网络配置"},{"id":"root用户密码及创建新用户","depth":2,"text":"root用户密码及创建新用户"},{"id":"安装引导程序-grub","depth":2,"text":"安装引导程序 grub"},{"id":"退出重启安装完成","depth":2,"text":"退出重启，安装完成"},{"id":"开启网络","depth":2,"text":"开启网络"},{"id":"安装-kde-plasma桌面环境","depth":2,"text":"安装 KDE plasma桌面环境"},{"id":"配置-sddm","depth":2,"text":"配置 sddm"}]}},"_type":"markdown","_id":"content:essay:7.ArchLinux重开备忘录.md","_source":"content","_file":"essay/7.ArchLinux重开备忘录.md","_stem":"essay/7.ArchLinux重开备忘录","_extension":"md"}
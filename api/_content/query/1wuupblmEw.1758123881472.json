{"_path":"/ramble/战巫","_dir":"","_draft":false,"_partial":false,"_locale":"","title":"战巫","description":"桜舞には、神に仕え、人の世を乱す『夜魔やま』を狩る者――『魔祓い』の一族が暮らしていた。\nその一族――神子園家と、伏守家の間で結ばれた約定により、奏真は一人の少女と出会う。\n神子園姫華みこその ひめか。奏真と変わらない歳の……けれどその身に特別な宿命を負った少女。","subtitle":"戦巫〈センナギ〉―穢れた契りと神ころも","date":"2023/02/13","product":"Escu:de / 2023-10-29 / 民俗 巫女 战斗 调教","official":"https://www.escude.co.jp/product/sen_nagi/top.html","tags":"战斗 悬疑 剧情","cover":"/img/ramble/战巫/sen_nagi.png","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"桜舞には、神に仕え、人の世を乱す『夜魔やま』を狩る者――『魔祓い』の一族が暮らしていた。\nその一族――神子園家と、伏守家の間で結ばれた約定により、奏真は一人の少女と出会う。\n神子園姫華みこその ひめか。奏真と変わらない歳の……けれどその身に特別な宿命を負った少女。"}]},{"type":"element","tag":"h1","props":{"id":"初始化"},"children":[{"type":"text","value":"初始化"}]},{"type":"element","tag":"h2","props":{"id":"一创建仓库"},"children":[{"type":"text","value":"一、创建仓库"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"GitHub 创建项目仓库，git clone拉取项目"}]},{"type":"element","tag":"h2","props":{"id":"二初始化"},"children":[{"type":"text","value":"二、初始化"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"创建main.go文件，在项目根目录下执行 go mod init <项目名> ，添加了go.mod，完成初始化"}]},{"type":"element","tag":"h2","props":{"id":"三安装gin"},"children":[{"type":"text","value":"三、安装gin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"gin "},{"type":"element","tag":"a","props":{"href":"https://gin-gonic.com/zh-cn/docs/","rel":["nofollow"]},"children":[{"type":"text","value":"官方文档"}]},{"type":"text","value":"\n下载安装：在项目根目录下执行"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"go get -u github.com/gin-gonic/gin\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"go get -u github.com/gin-gonic/gin\n"}]}]},{"type":"element","tag":"h2","props":{"id":"四搭建项目结构"},"children":[{"type":"text","value":"四、搭建项目结构"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"gin是灵活的web框架，不会限制我们的项目结构，所以需要我们自己去建立"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"项目结构如下："}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"config 网站配置、参数等等\nmodel 数据，读写\napi(controller) 前后端接口\nmiddleware 中间件，登录验证、跨域等等\nroutes 路由接口\nutils 工具包，实现公用的功能\nupload 上传下载，托管静态资源\nweb 前端页面托管"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":""}]}]},{"type":"element","tag":"h2","props":{"id":"五网站配置参数"},"children":[{"type":"text","value":"五、网站配置参数"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"可以在config文件夹下新建config.go文件，在其中写基本配置参数"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"不过此处使用"},{"type":"element","tag":"a","props":{"href":"https://ini.unknwon.io/","rel":["nofollow"]},"children":[{"type":"text","value":"go ini"}]},{"type":"text","value":"来进行配置\n安装go ini，在根目录下执行"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"go get gopkg.in/ini.v1\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"go get gopkg.in/ini.v1\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在config文件夹下新建config.ini文件，在其中写网站的基本配置参数\nini写法："}]},{"type":"element","tag":"pre","props":{"className":["language-ini"],"code":"# 注释\n[分区]\nkey=value\n","language":"ini","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# 注释\n[分区]\nkey=value\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"配置如下"}]},{"type":"element","tag":"pre","props":{"className":["language-ini"],"code":"[server]\nAppMode=debug\nHttpPort=:3000\n\n[database]\nDb=postgresql\nDbHost=localhost\nDbPort=5432\nDbUser=postgres\nDbPassword=123456\nDbName=ginblog\n","language":"ini","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"[server]\nAppMode=debug\nHttpPort=:3000\n\n[database]\nDb=postgresql\nDbHost=localhost\nDbPort=5432\nDbUser=postgres\nDbPassword=123456\nDbName=ginblog\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在utils下新建setting.go，将config.ini的参数引入并作为全局变量"}]},{"type":"element","tag":"pre","props":{"className":["language-go"],"code":"var (\n    AppMode  string\n    HttpPort string\n\n    Db         string\n    DbHost     string\n    DbPort     string\n    DbUser     string\n    DbPassword string\n    DbName     string\n)\n\nfunc init() {\n    file, err := ini.Load(\"../config/config.ini\")\n    if err != nil {\n        fmt.Println(\"配置文件读取错误，请检查文件路径：\", err)\n    }\n    loadServer(file)\n    loadData(file)\n}\n//加载server配置\nfunc loadServer(file *ini.File) {\n    AppMode = file.Section(\"server\").Key(\"AppMode\").MustString(\"debug\")\n    HttpPort = file.Section(\"server\").Key(\"HttpPort\").MustString(\":3000\")\n}\n//加载database配置\nfunc loadData(file *ini.File) {\n    Db = file.Section(\"database\").Key(\"Db\").MustString(\"postgresql\")\n    DbHost = file.Section(\"database\").Key(\"DbHost\").MustString(\"localhost\")\n    DbPort = file.Section(\"database\").Key(\"DbPort\").MustString(\"5432\")\n    DbUser = file.Section(\"database\").Key(\"DbUser\").MustString(\"postgres\")\n    DbPassword = file.Section(\"database\").Key(\"DbPassword\").MustString(\"123456\")\n    DbName = file.Section(\"database\").Key(\"DbName\").MustString(\"ginblog\")\n}\n\n","language":"go","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"var (\n    AppMode  string\n    HttpPort string\n\n    Db         string\n    DbHost     string\n    DbPort     string\n    DbUser     string\n    DbPassword string\n    DbName     string\n)\n\nfunc init() {\n    file, err := ini.Load(\"../config/config.ini\")\n    if err != nil {\n        fmt.Println(\"配置文件读取错误，请检查文件路径：\", err)\n    }\n    loadServer(file)\n    loadData(file)\n}\n//加载server配置\nfunc loadServer(file *ini.File) {\n    AppMode = file.Section(\"server\").Key(\"AppMode\").MustString(\"debug\")\n    HttpPort = file.Section(\"server\").Key(\"HttpPort\").MustString(\":3000\")\n}\n//加载database配置\nfunc loadData(file *ini.File) {\n    Db = file.Section(\"database\").Key(\"Db\").MustString(\"postgresql\")\n    DbHost = file.Section(\"database\").Key(\"DbHost\").MustString(\"localhost\")\n    DbPort = file.Section(\"database\").Key(\"DbPort\").MustString(\"5432\")\n    DbUser = file.Section(\"database\").Key(\"DbUser\").MustString(\"postgres\")\n    DbPassword = file.Section(\"database\").Key(\"DbPassword\").MustString(\"123456\")\n    DbName = file.Section(\"database\").Key(\"DbName\").MustString(\"ginblog\")\n}\n\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在使用配置参数时调用setting.go，这样做是为了将配置参数抽离出来，当需要更改时只需要更改ini配置文件里面的配置"}]},{"type":"element","tag":"h2","props":{"id":"六路由"},"children":[{"type":"text","value":"六、路由"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在routes文件夹下建立router.go文件,作为路由入口文件"}]},{"type":"element","tag":"pre","props":{"className":["language-go"],"code":"func InitRouter() {\n    gin.SetMode(utils.AppMode)\n    r := gin.Default()\n\n    router := r.Group(\"api/v1\")\n    {\n        router.GET(\"hello\", func(ctx *gin.Context) {\n            ctx.JSON(http.StatusOK, gin.H{\n                \"msg\": \"ok\",\n            })\n        })\n\n    }\n\n    r.Run(utils.HttpPort)\n}\n","language":"go","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"func InitRouter() {\n    gin.SetMode(utils.AppMode)\n    r := gin.Default()\n\n    router := r.Group(\"api/v1\")\n    {\n        router.GET(\"hello\", func(ctx *gin.Context) {\n            ctx.JSON(http.StatusOK, gin.H{\n                \"msg\": \"ok\",\n            })\n        })\n\n    }\n\n    r.Run(utils.HttpPort)\n}\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在main中使用"}]},{"type":"element","tag":"pre","props":{"className":["language-go"],"code":"func main() {\n    routes.InitRouter()\n}\n","language":"go","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"func main() {\n    routes.InitRouter()\n}\n"}]}]},{"type":"element","tag":"h2","props":{"id":"测试"},"children":[{"type":"text","value":"测试"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"运行main.go\n控制台打印"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.\n\n[GIN-debug] [WARNING] Running in \"debug\" mode. Switch to \"release\" mode in production.\n - using env:   export GIN_MODE=release\n - using code:  gin.SetMode(gin.ReleaseMode)\n\n[GIN-debug] GET    /api/v1/hello             --> gin-vue-blog/routes.InitRouter.func1 (3 handlers)\n[GIN-debug] [WARNING] You trusted all proxies, this is NOT safe. We recommend you to set a value.\nPlease check https://pkg.go.dev/github.com/gin-gonic/gin#readme-don-t-trust-all-proxies for details.\n[GIN-debug] Listening and serving HTTP on :3000\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.\n\n[GIN-debug] [WARNING] Running in \"debug\" mode. Switch to \"release\" mode in production.\n - using env:   export GIN_MODE=release\n - using code:  gin.SetMode(gin.ReleaseMode)\n\n[GIN-debug] GET    /api/v1/hello             --> gin-vue-blog/routes.InitRouter.func1 (3 handlers)\n[GIN-debug] [WARNING] You trusted all proxies, this is NOT safe. We recommend you to set a value.\nPlease check https://pkg.go.dev/github.com/gin-gonic/gin#readme-don-t-trust-all-proxies for details.\n[GIN-debug] Listening and serving HTTP on :3000\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"浏览器访问 localhost:3000/api/v1/hello\n页面显示"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"{\"msg\":\"ok\"}\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\"msg\":\"ok\"}\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"OK,一切正常"}]}],"toc":{"title":"","searchDepth":2,"depth":3,"links":[{"id":"一创建仓库","depth":2,"text":"一、创建仓库"},{"id":"二初始化","depth":2,"text":"二、初始化"},{"id":"三安装gin","depth":2,"text":"三、安装gin"},{"id":"四搭建项目结构","depth":2,"text":"四、搭建项目结构"},{"id":"五网站配置参数","depth":2,"text":"五、网站配置参数"},{"id":"六路由","depth":2,"text":"六、路由"},{"id":"测试","depth":2,"text":"测试"}]}},"_type":"markdown","_id":"content:ramble:战巫.md","_source":"content","_file":"ramble/战巫.md","_stem":"ramble/战巫","_extension":"md"}